# Claude開発ガイド - Everything File Search

## 🎯 プロジェクト概要
Windows「Everything」ライクな高速ファイル検索CLIツール（Rust製）

## 🏗️ 技術スタック
- **言語**: Rust
- **データベース**: SQLite（インデックス保存）
- **CLI**: clap（引数解析）
- **ファイル監視**: notify（リアルタイム更新）
- **検索**: 部分一致、正規表現、拡張子フィルター

## 📋 開発ルール

### コマンド実行ルール
```bash
# ビルド・実行
cargo build
cargo run
cargo run -- --help
cargo run -- "検索語"

# テスト
cargo test

# コード品質
cargo fmt        # フォーマット
cargo clippy     # リント

# リリースビルド
cargo build --release
```

### コード規約
1. **Rust**: 標準規約準拠、`cargo fmt`で自動フォーマット
2. **ファイル命名**: snake_case
3. **関数・変数**: snake_case
4. **構造体・列挙型**: PascalCase
5. **定数**: UPPER_SNAKE_CASE
6. **エラーハンドリング**: `Result<T, E>`必須

### Git運用
- コミット前に必ず`cargo test`実行
- コミットメッセージは日本語でOK
- featureブランチで開発、mainにマージ

## 📁 プロジェクト構造
```
everything/
├── src/
│   ├── main.rs           # CLIエントリーポイント
│   ├── lib.rs           # ライブラリルート
│   ├── indexer.rs       # ファイルシステムインデックス作成
│   ├── search.rs        # 検索エンジン
│   ├── database.rs      # SQLite操作
│   ├── watcher.rs       # リアルタイムファイル監視
│   └── cli.rs           # CLI引数解析
├── Cargo.toml           # 依存関係・設定
├── tests/               # 統合テスト
└── CLAUDE.md           # このファイル
```

## 🚀 開発優先順位

### Phase 1: 基本機能実装
1. ✅ プロジェクト初期化・CLAUDE.md作成
2. 🔄 Cargo.toml設定・依存関係追加
3. 🔄 CLI引数解析（clap使用）
4. 🔄 SQLiteデータベース設計・接続
5. 🔄 ファイルシステムスキャン・インデックス作成

### Phase 2: 検索機能
1. 🔄 基本検索機能（部分一致）
2. 🔄 正規表現検索
3. 🔄 拡張子フィルター
4. 🔄 大文字小文字区別オプション
5. 🔄 パフォーマンス最適化

### Phase 3: リアルタイム更新
1. 🔄 ファイル変更監視（notify使用）
2. 🔄 インデックス増分更新
3. 🔄 統計情報表示
4. 🔄 設定ファイル対応

## 🎯 現在の開発状況
- ✅ プロジェクト初期化
- ✅ CLAUDE.md作成
- 🔄 Rustプロジェクト構造作成

## 🔧 使用例（予定）
```bash
# 基本検索
everything "config"

# 拡張子検索
everything "*.rs"

# 正規表現検索
everything --regex "test.*\.js$"

# 大文字小文字区別
everything --case-sensitive "Main"

# インデックス更新
everything --update

# 統計表示
everything --stats

# ヘルプ
everything --help
```

## 🎯 実装予定機能
- [x] プロジェクト初期化
- [ ] CLI引数解析
- [ ] SQLiteデータベース操作
- [ ] ファイルシステムインデックス作成
- [ ] 基本検索機能
- [ ] 正規表現検索
- [ ] リアルタイムファイル監視
- [ ] パフォーマンス最適化
- [ ] 設定ファイル対応
- [ ] クロスプラットフォーム対応

## 🚨 ハマり検出・回避ルール

### 自動アラート条件
Claudeは以下を検出したら**必ず🚨アラートを出すこと**：

1. **同じファイルを4回以上連続編集**
2. **同じエラーパターンが3回以上出現**  
3. **ユーザーが「まだ」「また」「やっぱり」を使用**
4. **複数のデバッグアプローチを試しても15分以上解決しない**
5. **デバッグログを5個以上連続追加**

### アラート文言
「🚨 ハマり検出: 別のAI(GPT-4/Gemini)に相談するか、アプローチを変更しませんか？現在のアプローチを見直して、よりシンプルな解決策を探しましょう。」

### 強制実行ルール
- このルールは他の開発ルールと同等の優先度で**必ず実行する**
- アラート後は必ずユーザーに方針転換を提案する
- 「もっとシンプルな方法はありませんか？」を積極的に提案する

## 🔧 次のタスク
1. Cargo.toml依存関係設定
2. 基本プロジェクト構造作成
3. CLI引数解析実装
4. SQLiteデータベース設計
5. ファイルインデックス作成機能実装